var Pt=Object.defineProperty,Lt=Object.defineProperties;var $t=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Se=Object.prototype.propertyIsEnumerable;var Te=(t,e,n)=>e in t?Pt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,E=(t,e)=>{for(var n in e||(e={}))Ce.call(e,n)&&Te(t,n,e[n]);if(z)for(var n of z(e))Se.call(e,n)&&Te(t,n,e[n]);return t},G=(t,e)=>Lt(t,$t(e));var B=(t,e)=>{var n={};for(var i in t)Ce.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&z)for(var i of z(t))e.indexOf(i)<0&&Se.call(t,i)&&(n[i]=t[i]);return n};var oe,g,qe,Q,ze,Ie,Ke,ne={},Ve=[],Ot=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function H(t,e){for(var n in e)t[n]=e[n];return t}function Xe(t){var e=t.parentNode;e&&e.removeChild(t)}function s(t,e,n){var i,r,o,l={};for(o in e)o=="key"?i=e[o]:o=="ref"?r=e[o]:l[o]=e[o];if(arguments.length>2&&(l.children=arguments.length>3?oe.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(o in t.defaultProps)l[o]===void 0&&(l[o]=t.defaultProps[o]);return V(t,l,i,r,null)}function V(t,e,n,i,r){var o={type:t,props:e,key:n,ref:i,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r==null?++qe:r};return r==null&&g.vnode!=null&&g.vnode(o),o}function k(t){return t.children}function X(t,e){this.props=t,this.context=e}function j(t,e){if(e==null)return t.__?j(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?j(t):null}function Ze(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return Ze(t)}}function fe(t){(!t.__d&&(t.__d=!0)&&Q.push(t)&&!se.__r++||Ie!==g.debounceRendering)&&((Ie=g.debounceRendering)||ze)(se)}function se(){for(var t;se.__r=Q.length;)t=Q.sort(function(e,n){return e.__v.__b-n.__v.__b}),Q=[],t.some(function(e){var n,i,r,o,l,c;e.__d&&(l=(o=(n=e).__v).__e,(c=n.__P)&&(i=[],(r=H({},o)).__v=o.__v+1,ge(c,o,r,n.__n,c.ownerSVGElement!==void 0,o.__h!=null?[l]:null,i,l==null?j(o):l,o.__h),st(i,o),o.__e!=l&&Ze(o)))})}function et(t,e,n,i,r,o,l,c,u,d){var a,m,h,f,_,T,v,y=i&&i.__k||Ve,N=y.length;for(n.__k=[],a=0;a<e.length;a++)if((f=n.__k[a]=(f=e[a])==null||typeof f=="boolean"?null:typeof f=="string"||typeof f=="number"||typeof f=="bigint"?V(null,f,null,null,f):Array.isArray(f)?V(k,{children:f},null,null,null):f.__b>0?V(f.type,f.props,f.key,null,f.__v):f)!=null){if(f.__=n,f.__b=n.__b+1,(h=y[a])===null||h&&f.key==h.key&&f.type===h.type)y[a]=void 0;else for(m=0;m<N;m++){if((h=y[m])&&f.key==h.key&&f.type===h.type){y[m]=void 0;break}h=null}ge(t,f,h=h||ne,r,o,l,c,u,d),_=f.__e,(m=f.ref)&&h.ref!=m&&(v||(v=[]),h.ref&&v.push(h.ref,null,f),v.push(m,f.__c||_,f)),_!=null?(T==null&&(T=_),typeof f.type=="function"&&f.__k===h.__k?f.__d=u=tt(f,u,t):u=nt(t,f,h,y,_,u),typeof n.type=="function"&&(n.__d=u)):u&&h.__e==u&&u.parentNode!=t&&(u=j(h))}for(n.__e=T,a=N;a--;)y[a]!=null&&(typeof n.type=="function"&&y[a].__e!=null&&y[a].__e==n.__d&&(n.__d=j(i,a+1)),ot(y[a],y[a]));if(v)for(a=0;a<v.length;a++)it(v[a],v[++a],v[++a])}function tt(t,e,n){for(var i,r=t.__k,o=0;r&&o<r.length;o++)(i=r[o])&&(i.__=t,e=typeof i.type=="function"?tt(i,e,n):nt(n,i,i,r,i.__e,e));return e}function nt(t,e,n,i,r,o){var l,c,u;if(e.__d!==void 0)l=e.__d,e.__d=void 0;else if(n==null||r!=o||r.parentNode==null)e:if(o==null||o.parentNode!==t)t.appendChild(r),l=null;else{for(c=o,u=0;(c=c.nextSibling)&&u<i.length;u+=2)if(c==r)break e;t.insertBefore(r,o),l=o}return l!==void 0?l:r.nextSibling}function Gt(t,e,n,i,r){var o;for(o in n)o==="children"||o==="key"||o in e||ie(t,o,null,n[o],i);for(o in e)r&&typeof e[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||n[o]===e[o]||ie(t,o,e[o],n[o],i)}function Ae(t,e,n){e[0]==="-"?t.setProperty(e,n):t[e]=n==null?"":typeof n!="number"||Ot.test(e)?n:n+"px"}function ie(t,e,n,i,r){var o;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof i=="string"&&(t.style.cssText=i=""),i)for(e in i)n&&e in n||Ae(t.style,e,"");if(n)for(e in n)i&&n[e]===i[e]||Ae(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+o]=n,n?i||t.addEventListener(e,o?Re:De,o):t.removeEventListener(e,o?Re:De,o);else if(e!=="dangerouslySetInnerHTML"){if(r)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=n==null?"":n;break e}catch{}typeof n=="function"||(n!=null&&(n!==!1||e[0]==="a"&&e[1]==="r")?t.setAttribute(e,n):t.removeAttribute(e))}}function De(t){this.l[t.type+!1](g.event?g.event(t):t)}function Re(t){this.l[t.type+!0](g.event?g.event(t):t)}function ge(t,e,n,i,r,o,l,c,u){var d,a,m,h,f,_,T,v,y,N,C,p=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(u=n.__h,c=e.__e=n.__e,e.__h=null,o=[c]),(d=g.__b)&&d(e);try{e:if(typeof p=="function"){if(v=e.props,y=(d=p.contextType)&&i[d.__c],N=d?y?y.props.value:d.__:i,n.__c?T=(a=e.__c=n.__c).__=a.__E:("prototype"in p&&p.prototype.render?e.__c=a=new p(v,N):(e.__c=a=new X(v,N),a.constructor=p,a.render=Bt),y&&y.sub(a),a.props=v,a.state||(a.state={}),a.context=N,a.__n=i,m=a.__d=!0,a.__h=[]),a.__s==null&&(a.__s=a.state),p.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=H({},a.__s)),H(a.__s,p.getDerivedStateFromProps(v,a.__s))),h=a.props,f=a.state,m)p.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(p.getDerivedStateFromProps==null&&v!==h&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(v,N),!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(v,a.__s,N)===!1||e.__v===n.__v){a.props=v,a.state=a.__s,e.__v!==n.__v&&(a.__d=!1),a.__v=e,e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(w){w&&(w.__=e)}),a.__h.length&&l.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(v,a.__s,N),a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(h,f,_)})}a.context=N,a.props=v,a.state=a.__s,(d=g.__r)&&d(e),a.__d=!1,a.__v=e,a.__P=t,d=a.render(a.props,a.state,a.context),a.state=a.__s,a.getChildContext!=null&&(i=H(H({},i),a.getChildContext())),m||a.getSnapshotBeforeUpdate==null||(_=a.getSnapshotBeforeUpdate(h,f)),C=d!=null&&d.type===k&&d.key==null?d.props.children:d,et(t,Array.isArray(C)?C:[C],e,n,i,r,o,l,c,u),a.base=e.__e,e.__h=null,a.__h.length&&l.push(a),T&&(a.__E=a.__=null),a.__e=!1}else o==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=Mt(n.__e,e,n,i,r,o,l,u);(d=g.diffed)&&d(e)}catch(w){e.__v=null,(u||o!=null)&&(e.__e=c,e.__h=!!u,o[o.indexOf(c)]=null),g.__e(w,e,n)}}function st(t,e){g.__c&&g.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(i){i.call(n)})}catch(i){g.__e(i,n.__v)}})}function Mt(t,e,n,i,r,o,l,c){var u,d,a,m=n.props,h=e.props,f=e.type,_=0;if(f==="svg"&&(r=!0),o!=null){for(;_<o.length;_++)if((u=o[_])&&"setAttribute"in u==!!f&&(f?u.localName===f:u.nodeType===3)){t=u,o[_]=null;break}}if(t==null){if(f===null)return document.createTextNode(h);t=r?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,h.is&&h),o=null,c=!1}if(f===null)m===h||c&&t.data===h||(t.data=h);else{if(o=o&&oe.call(t.childNodes),d=(m=n.props||ne).dangerouslySetInnerHTML,a=h.dangerouslySetInnerHTML,!c){if(o!=null)for(m={},_=0;_<t.attributes.length;_++)m[t.attributes[_].name]=t.attributes[_].value;(a||d)&&(a&&(d&&a.__html==d.__html||a.__html===t.innerHTML)||(t.innerHTML=a&&a.__html||""))}if(Gt(t,h,m,r,c),a)e.__k=[];else if(_=e.props.children,et(t,Array.isArray(_)?_:[_],e,n,i,r&&f!=="foreignObject",o,l,o?o[0]:n.__k&&j(n,0),c),o!=null)for(_=o.length;_--;)o[_]!=null&&Xe(o[_]);c||("value"in h&&(_=h.value)!==void 0&&(_!==t.value||f==="progress"&&!_||f==="option"&&_!==m.value)&&ie(t,"value",_,m.value,!1),"checked"in h&&(_=h.checked)!==void 0&&_!==t.checked&&ie(t,"checked",_,m.checked,!1))}return t}function it(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(i){g.__e(i,n)}}function ot(t,e,n){var i,r;if(g.unmount&&g.unmount(t),(i=t.ref)&&(i.current&&i.current!==t.__e||it(i,null,e)),(i=t.__c)!=null){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(o){g.__e(o,e)}i.base=i.__P=null}if(i=t.__k)for(r=0;r<i.length;r++)i[r]&&ot(i[r],e,typeof t.type!="function");n||t.__e==null||Xe(t.__e),t.__e=t.__d=void 0}function Bt(t,e,n){return this.constructor(t,n)}function Ut(t,e,n){var i,r,o;g.__&&g.__(t,e),r=(i=typeof n=="function")?null:n&&n.__k||e.__k,o=[],ge(e,t=(!i&&n||e).__k=s(k,null,[t]),r||ne,ne,e.ownerSVGElement!==void 0,!i&&n?[n]:r?null:e.firstChild?oe.call(e.childNodes):null,o,!i&&n?n:r?r.__e:e.firstChild,i),st(o,t)}function re(t,e){var n={__c:e="__cC"+Ke++,__:t,Consumer:function(i,r){return i.children(r)},Provider:function(i){var r,o;return this.getChildContext||(r=[],(o={})[e]=this,this.getChildContext=function(){return o},this.shouldComponentUpdate=function(l){this.props.value!==l.value&&r.some(fe)},this.sub=function(l){r.push(l);var c=l.componentWillUnmount;l.componentWillUnmount=function(){r.splice(r.indexOf(l),1),c&&c.call(l)}}),i.children}};return n.Provider.__=n.Consumer.contextType=n}oe=Ve.slice,g={__e:function(t,e,n,i){for(var r,o,l;e=e.__;)if((r=e.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(t)),l=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(t,i||{}),l=r.__d),l)return r.__E=r}catch(c){t=c}throw t}},qe=0,X.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=H({},this.state),typeof t=="function"&&(t=t(H({},n),this.props)),t&&H(n,t),t!=null&&this.__v&&(e&&this.__h.push(e),fe(this))},X.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),fe(this))},X.prototype.render=k,Q=[],ze=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,se.__r=0,Ke=0;let rt="America/New_York";function Ht(t){rt=t}function U(t){t=new Date(t||Date.now());const e={},n="2-digit";return Intl.DateTimeFormat("en-US",{timeZone:rt,hourCycle:"h23",year:"numeric",month:n,day:n,hour:n,minute:n,second:n}).formatToParts(t).forEach(i=>e[i.type]=i.value),{date:`${e.year}-${e.month}-${e.day}`,time:`${e.hour}:${e.minute}:${e.second}`}}function W(t){const e=t.split(":").map(Number),n=e[0]>=12?"PM":"AM";return e[0]=e[0]%12||12,e.map(i=>String(i).padStart(2,"0")).join(":").replace(/:00$/,"").replace(/^0/,"")+" "+n}class at extends Error{constructor(e){super(`Auth data "${e}" missing or expired`),this.name="ReauthNeeded"}}class Ft{constructor(e,n=localStorage){this.storageKey=e,this.storage=n}getData(){const e=this.storage.getItem(this.storageKey);if(e){const{swid:n,accessToken:i,expires:r}=JSON.parse(e),o=U(new Date(r)),l=U();if(o.date>l.date||o.date===l.date&&o.time>l.time&&o.time>="17")return{swid:n,accessToken:i}}throw new at(this.storageKey)}setData(e){this.storage.setItem(this.storageKey,JSON.stringify(e))}deleteData(){this.storage.removeItem(this.storageKey)}}const jt="modulepreload",Pe={},Wt="/bg1/",Le=function(e,n){return!n||n.length===0?e():Promise.all(n.map(i=>{if(i=`${Wt}${i}`,i in Pe)return;Pe[i]=!0;const r=i.endsWith(".css"),o=r?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${o}`))return;const l=document.createElement("link");if(l.rel=r?"stylesheet":jt,r||(l.as="script",l.crossOrigin=""),l.href=i,document.head.appendChild(l),r)return new Promise((c,u)=>{l.addEventListener("load",c),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e())},Qt=8e3;async function he(t,e={}){const d=e,{params:n,data:i,timeout:r=Qt}=d;e=B(d,["params","data","timeout"]),n&&(t+="?"+Object.entries(n).filter(([,a])=>a!=="").map(a=>a.map(encodeURIComponent).join("=")).join("&")),i&&(e.method||(e.method="POST"),e.headers=G(E({},e.headers||{}),{"Content-Type":"application/json"}),e.body=JSON.stringify(i));const l=new AbortController;e.signal=l.signal;const c=setTimeout(()=>l.abort(),r);let u;try{u=await fetch(t,e)}catch(a){return console.error(a),{status:0,data:null}}finally{clearTimeout(c)}return{status:u.status,data:(u.headers.get("Content-Type")||"").startsWith("application/json")?await u.json():{}}}function Yt(t){switch(t){case"./data/dlr.ts":return Le(()=>import("./dlr.js"),[]);case"./data/wdw.ts":return Le(()=>import("./wdw.js"),[]);default:return new Promise(function(e,n){(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+t)))})}}const _e={"https://disneyworld.disney.go.com":"WDW","https://disneyland.disney.go.com":"DLR"},Jt={WDW:"wdw-itinerary-api",DLR:"dlr-itinerary-web-api"};function qt(t){return t in _e}class lt extends Error{constructor(e,n="Request failed"){super(`${n}: ${JSON.stringify(e)}`),this.response=e,this.name="RequestError"}}const K=t=>t.split(";")[0];class ye{constructor(e){this.guestNames=new Map,this._primaryGuestId="",this.origin=e.origin,this.getAuthData=e.getAuthData,this.data=e.data,this.bookingStack=new zt}static async load(e){const n=(await Yt(`./data/${_e[e.origin].toLocaleLowerCase()}.ts`)).default;return new ye(G(E({},e),{data:n}))}get resort(){return _e[this.origin]}get parks(){return this.data.parks}async plusExperiences(e){return(await this.request({path:`/tipboard-vas/api/v1/parks/${encodeURIComponent(e.id)}/experiences`,key:"availableExperiences"})).map(i=>E(E({},i),this.data.experiences[i.id])).filter(i=>!!(i.name&&i.flex))}async guests(e){const n=await this.request({path:"/ea-vas/api/v1/guests",params:{productType:"FLEX",experienceId:e.experience.id,parkId:e.park.id}});this._primaryGuestId=n.primaryGuestId;const i=d=>{var a=d,{firstName:l,lastName:c}=a,u=B(a,["firstName","lastName"]);return G(E({},u),{name:`${l} ${c}`.trim()})},r=n.ineligibleGuests.map(i),o=n.guests.map(i).filter(l=>"ineligibleReason"in l?(r.push(l),!1):!0);return[...o,...r].forEach(l=>{this.guestNames.has(l.id)||this.guestNames.set(l.id,l.name)}),o.sort((l,c)=>l.name.localeCompare(c.name)),r.sort((l,c)=>{const u=l.name.localeCompare(c.name);return l.eligibleAfter||c.eligibleAfter?(l.eligibleAfter||"99").localeCompare(c.eligibleAfter||"99")||u:l.ineligibleReason===c.ineligibleReason?u:l.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"?-1:c.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"?1:u}),{guests:o,ineligibleGuests:r}}async primaryGuestId(e){return this._primaryGuestId||await this.guests(e),this._primaryGuestId}async offer({experience:e,park:n,guests:i}){const{id:r,date:o,startTime:l,endTime:c,changeStatus:u}=await this.request({path:"/ea-vas/api/v1/products/flex/offers",method:"POST",data:{productType:"FLEX",guestIds:i.map(d=>d.id),primaryGuestId:await this.primaryGuestId({experience:e,park:n}),parkId:n.id,experienceId:e.id,selectedTime:e.flex.nextAvailableTime},key:"offer"});return{id:r,start:{date:o,time:l},end:{date:o,time:c},changeStatus:u}}async cancelOffer(e){await this.request({path:`/ea-vas/api/v1/offers/${encodeURIComponent(e.id)}`,method:"DELETE",params:{productType:"FLEX"},userId:!1})}async book(e){const{singleExperienceDetails:{experienceId:n,parkId:i},entitlements:r,startDateTime:o,endDateTime:l}=await this.request({path:"/ea-vas/api/v1/products/flex/bookings",method:"POST",userId:!1,data:{offerId:e.id},key:"booking"});return this.bookings(),{experience:{id:n,name:this.data.experiences[n].name},park:this.data.parks.find(c=>c.id===i),start:U(o),end:U(l),guests:r.map(c=>({id:c.guestId,name:this.guestNames.get(c.guestId)||"",entitlementId:c.id}))}}async cancelBooking(e){const i=e.map(r=>r.entitlementId).map(encodeURIComponent).join(",");await this.request({path:`/ea-vas/api/v1/entitlements/${i}`,method:"DELETE",userId:!1})}async bookings(){const{swid:e}=this.getAuthData(),n=new Date(Date.now()),i=Jt[this.resort],{items:r=[],assets:o={},profiles:l={}}=await this.request({path:`/plan/${i}/api/v1/itinerary-items/${e}`,params:{destination:this.resort,fields:"items,profiles,assets","item-types":"FASTPASS","guest-locators":e+";type=swid","guest-locator-groups":"MY_FAMILY","start-date":U(n).date,"end-date":U(new Date(n.getTime()).setDate(n.getDate()+1)).date,"show-friends":"false"},userId:!1}),c=Object.fromEntries(this.parks.map(m=>[m.id,m])),u=U(new Date(n.getTime()).setMinutes(n.getMinutes()-15)),d=new Set(["FLEX","OTHER"]),a=r.filter(m=>m.type==="FASTPASS"&&d.has(m.kind)).filter(m=>m.displayEndDate>=u.date&&(!m.displayEndTime||m.displayEndTime>=u.time)).map(m=>{const h=K(m.facility),f=o[m.facility],{name:_}=this.data.experiences[h]||f,T=K(f.location),v={experience:{id:h,name:_},park:c[T],start:{date:m.displayStartDate,time:m.displayStartTime},end:E({date:m.displayEndDate},m.displayEndTime&&{time:m.displayEndTime}),guests:m.guests.map(y=>{const{name:N}=l[y.id];return E({id:K(y.id),entitlementId:y.entitlementId,name:`${N.firstName} ${N.lastName}`.trim()},y.redemptionsRemaining!==void 0&&{redemptions:y.redemptionsRemaining})})};return m.multipleExperiences&&(v.experience={id:"",name:"Multiple Experiences"},v.choices=m.assets.filter(y=>!y.excluded&&!y.original).map(({content:y})=>{const N=K(y),{name:C}=this.data.experiences[N]||o[y];return{id:N,name:C}}).sort((y,N)=>y.name.localeCompare(N.name))),v}).sort((m,h)=>(m.start.date+m.start.time).localeCompare(h.start.date+h.start.time));return this.bookingStack.update(a),a}isRebookable(e){return this.bookingStack.isRebookable(e)}async request(e){var d;const{swid:n,accessToken:i}=this.getAuthData(),r=this.origin+e.path,o=E({},e.params);((d=e.userId)==null||d)&&(o.userId=n);const{status:l,data:c}=await he(r,{method:e.method||"GET",params:o,data:e.data,headers:{Authorization:`BEARER ${i}`,"User-Agent":"Mozilla/5.0"},credentials:"omit"}),{key:u}=e;if(String(l)[0]==="2"&&(!u||c[u]))return u?c[u]:c;throw new lt({status:l,data:c})}}const $e="bg1.genie.bookings";class zt{constructor(e=!0){if(this.entitlementIds=[],this.mostRecent=new Map,!e)return;const{entitlementIds:n=[],mostRecent:i={}}=JSON.parse(localStorage.getItem($e)||"{}");this.entitlementIds=n,this.mostRecent=new Map(Object.entries(i))}isRebookable(e){return e.guests.every(n=>this.mostRecent.get(n.id)===n.entitlementId)}update(e){const n=new Map,i=new Set(this.entitlementIds);this.entitlementIds=e.filter(({choices:r})=>!r).map(r=>r.guests.map(({id:o,entitlementId:l})=>(this.entitlementIds.push(l),i.has(l)||n.set(o,n.has(o)?"":l),l))).flat(1),this.mostRecent=new Map([...this.mostRecent,...n]),n.size>0&&localStorage.setItem($e,JSON.stringify({entitlementIds:this.entitlementIds,mostRecent:Object.fromEntries(this.mostRecent)}))}}const ct={"https://vqguest-svc-wdw.wdprapps.disney.com":"WDW","https://vqguest-svc.wdprapps.disney.com":"DLR"};function Kt(t){return t in ct}function Vt(t){return t.sort((e,n)=>e.isPrimaryGuest!==n.isPrimaryGuest?Number(n.isPrimaryGuest)-Number(e.isPrimaryGuest):e.isPreselected!==n.isPreselected?Number(n.isPreselected)-Number(e.isPreselected):e.name.localeCompare(n.name))}class Z extends Error{constructor(e,n="Request failed"){super(`${n}: ${JSON.stringify(e)}`),this.response=e,this.name="RequestError"}}class Xt{constructor(e){this.origin=e.origin,this.getAuthData=e.getAuthData}get resort(){return ct[this.origin]}url(e){return`${this.origin}/application/v1/guest/${e}`}async getQueues(){return(await he(this.url("getQueues"))).data.queues.map(i=>{var r=i,{queueId:e}=r,n=B(r,["queueId"]);return G(E({},n),{id:e})}).sort((e,n)=>e.categoryContentId===n.categoryContentId?e.name.localeCompare(n.name):e.categoryContentId==="attraction"?-1:1)}async getQueue(e){const n=(await this.getQueues()).find(i=>i.id===e.id);if(n)return n;throw new Error("Queue not Found")}async getLinkedGuests(e){const{data:n}=await this.post({resource:"getLinkedGuests",data:{queueId:e.id}});return Vt(n.guests.map(c=>{var u=c,{guestId:i,firstName:r,lastName:o}=u,l=B(u,["guestId","firstName","lastName"]);return G(E({},l),{id:i,name:`${r} ${o}`.trim()})}))}async joinQueue(e,n){const i=n.map(l=>l.id),{status:r,data:o}=await this.post({resource:"joinQueue",data:{queueId:e.id,guestIds:i}});if(o.responseStatus==="OK"){const l=o.positions.find(c=>c.queueId===e.id&&c.guestIds.length>0&&i.some(u=>c.guestIds.includes(u)));if(!l)throw new Z({status:r,data:o});return{boardingGroup:l.boardingGroup,conflicts:{},closed:!1}}else if(o.responseStatus==="INVALID_GUEST"||o.responseStatus==="CLOSED_QUEUE"){const l=o.responseStatus==="CLOSED_QUEUE",c=new Set,u={};for(const m of o.conflicts)for(const h of m.guestIds){const f=n.find(_=>_.id===h);!f||(u[f.id]=m.conflictType,c.add(h))}const d=n.filter(m=>!c.has(m.id));if(l||d.length===0)return{boardingGroup:null,conflicts:u,closed:l};const a=await this.joinQueue(e,d);return a.conflicts=E(E({},u),a.conflicts),a}else throw new Z({status:r,data:o})}async post(e){const{status:n,data:i}=await he(this.url(e.resource),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`BEARER ${this.getAuthData().accessToken}`},body:JSON.stringify(e.data)});if(!n||n>=500)throw new Z({status:n,data:i});return{status:n,data:i}}}var J,R,Oe,Y=0,ut=[],Ge=g.__b,Me=g.__r,Be=g.diffed,Ue=g.__c,He=g.unmount;function ae(t,e){g.__h&&g.__h(R,t,Y||e),Y=0;var n=R.__H||(R.__H={__:[],__h:[]});return t>=n.__.length&&n.__.push({}),n.__[t]}function b(t){return Y=1,Zt(ft,t)}function Zt(t,e,n){var i=ae(J++,2);return i.t=t,i.__c||(i.__=[n?n(e):ft(void 0,e),function(r){var o=i.t(i.__[0],r);i.__[0]!==o&&(i.__=[o,i.__[1]],i.__c.setState({}))}],i.__c=R),i.__}function D(t,e){var n=ae(J++,3);!g.__s&&mt(n.__H,e)&&(n.__=t,n.__H=e,R.__H.__h.push(n))}function be(t){return Y=5,dt(function(){return{current:t}},[])}function dt(t,e){var n=ae(J++,7);return mt(n.__H,e)&&(n.__=t(),n.__H=e,n.__h=t),n.__}function q(t,e){return Y=8,dt(function(){return t},e)}function le(t){var e=R.context[t.__c],n=ae(J++,9);return n.c=t,e?(n.__==null&&(n.__=!0,e.sub(R)),e.props.value):t.__}function en(){for(var t;t=ut.shift();)if(t.__P)try{t.__H.__h.forEach(ee),t.__H.__h.forEach(pe),t.__H.__h=[]}catch(e){t.__H.__h=[],g.__e(e,t.__v)}}g.__b=function(t){R=null,Ge&&Ge(t)},g.__r=function(t){Me&&Me(t),J=0;var e=(R=t.__c).__H;e&&(e.__h.forEach(ee),e.__h.forEach(pe),e.__h=[])},g.diffed=function(t){Be&&Be(t);var e=t.__c;e&&e.__H&&e.__H.__h.length&&(ut.push(e)!==1&&Oe===g.requestAnimationFrame||((Oe=g.requestAnimationFrame)||function(n){var i,r=function(){clearTimeout(o),Fe&&cancelAnimationFrame(i),setTimeout(n)},o=setTimeout(r,100);Fe&&(i=requestAnimationFrame(r))})(en)),R=null},g.__c=function(t,e){e.some(function(n){try{n.__h.forEach(ee),n.__h=n.__h.filter(function(i){return!i.__||pe(i)})}catch(i){e.some(function(r){r.__h&&(r.__h=[])}),e=[],g.__e(i,n.__v)}}),Ue&&Ue(t,e)},g.unmount=function(t){He&&He(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(i){try{ee(i)}catch(r){e=r}}),e&&g.__e(e,n.__v))};var Fe=typeof requestAnimationFrame=="function";function ee(t){var e=R,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),R=e}function pe(t){var e=R;t.__c=t.__(),R=e}function mt(t,e){return!t||t.length!==e.length||e.some(function(n,i){return n!==t[i]})}function ft(t,e){return typeof e=="function"?e(t):e}const ht={bg:"bg-blue-500"},_t=re(ht),tn=_t.Provider,F=()=>le(_t),nn={normal:"py-1",small:"py-1.5 text-xs uppercase tracking-wide",full:"w-full py-3"};function P(t){const l=t,{type:e,className:n}=l,i=B(l,["type","className"]),r=(n||"")+" "+nn[e||"normal"],{bg:o}=F();return s("button",E({className:`${r} border-2 border-white rounded-lg px-2 ${o} text-white font-semibold disabled:opacity-50`},i))}function $({onClick:t,disabled:e,href:n,children:i}){return s("div",{className:"mb-20"},s("div",{className:"fixed bottom-0 left-0 w-full bg-white bg-opacity-75 text-center"},s("a",{href:n,className:"block max-w-2xl mx-auto px-3 pb-5"},s(P,{type:"full",onClick:t,disabled:e},i))))}function sn({title:t,children:e}){const{bg:n}=F();return s("div",{className:`flex flex-nowrap justify-end gap-x-2 gap-y-1 min-h-[52px] px-3 py-2 font-semibold text-white ${n}`},s("h1",{className:"flex-1 self-center py-0.5 text-xl overflow-hidden whitespace-nowrap"},t),e)}function ve(t){const o=t,{children:e,className:n}=o,i=B(o,["children","className"]),r=E({outer:"",inner:""},typeof n=="string"?{inner:n}:n);return s("div",E({className:`${r.outer} fixed inset-0`},i),s("div",{className:`${r.inner} max-w-2xl min-h-full mx-auto`},e))}function M(c){var u=c,{heading:t,buttons:e,className:n,theme:i,containerRef:r,children:o}=u,l=B(u,["heading","buttons","className","theme","containerRef","children"]);return s(tn,{value:i||ht},s(ve,E({className:{outer:`bg-white ${n||""}`,inner:"flex flex-col max-w-2xl h-full"}},l),s(sn,{title:t},e),s("div",{ref:r,className:"flex-1 overflow-auto px-3 pb-3"},o)))}const on="bg1.disclaimer.accepted",rn={bg:"bg-red-600"};function an(){const t=localStorage,e=on,[n,i]=b(!!t.getItem(e));return D(()=>{n&&t.setItem(e,"1")},[n,t,e]),n?null:s(ln,{onAccept:()=>i(!0)})}function ln({onAccept:t}){return s(M,{heading:"Warning!",theme:rn},s("p",null,'Use at your own risk. BG1 is highly experimental, for demonstration purposes only, and provided "as is" without warranty of any kind. It is in no way endorsed by or associated with the Walt Disney Company and could stop working at any time for any reason. To ensure the intended experience, always use the official Disney app.'),s($,{onClick:t},"Accept"))}const cn="17e2767256f";function un(t){return"deferredUuid"in t&&t.deferredUuid!==void 0}class dn{constructor(e,n,i,r=!1){this.iframe=e,this.resort=i,this.logging=r,this.handlers={},this.handshakeAcked=!1,this.onMessage=o=>{if(o.source!==this.iframe.contentWindow||o.data==="inner.loaded")return;const l=JSON.parse(o.data);this.logging&&console.log("Message:",l);const c=l.type==="message"?l.eventName:l.type,u=this.handlers[c],d=u?u("data"in l?l.data:null):void 0;un(l)&&this.send({type:"deferred",action:"resolve",deferredUuid:l.deferredUuid,data:d!=null?d:{}})},this.on("handshake",()=>{this.handshakeAcked||(this.handshakeAcked=!0,this.send({type:"handshakeAck"}),this.logging&&this.sendMessage("setLogLevel",{level:"log"}),this.sendMessage("workflow.execute",{name:"login"}))}),this.on("lightbox.hide",()=>this.open()),this.on("session.dateOfBirth.read",()=>this.open()),this.on("session.loggedin",({token:o})=>{n({swid:o.swid,accessToken:o.access_token,expires:new Date(o.exp)})})}open(){addEventListener("message",this.onMessage),this.iframe.src=this.authPageUrl,this.handshakeAcked=!1}close(){removeEventListener("message",this.onMessage)}on(e,n){this.handlers[e]=n}sendMessage(e,n){this.send({type:"message",eventName:e,data:n})}send(e){var n;(n=this.iframe.contentWindow)==null||n.postMessage(JSON.stringify(G(E({},e),{name:"lightbox-client-window"})),this.authPageUrl)}get authPageUrl(){return`https://cdn.registerdisney.go.com/v2/TPR-${this.resort}-LBSDK.IOS-PROD/en-US?include=l10n,config,html,js&buildId=${cn}`}}function mn({resort:t,onLogin:e}){const n=be(null);return D(()=>{if(!n.current)return;const i=new dn(n.current,e,t);return i.open(),()=>i.close()},[t,e,n]),s("iframe",{title:"Disney Login Form",ref:n,className:"fixed top-0 left-0 w-full h-full border-0"})}function fn({resort:t,authStore:e,children:n}){const[i,r]=b("Blank"),o=an();return D(()=>{function c(){if(!document.hidden)try{e.getData(),r("Client")}catch(u){if(u instanceof at)return r("LoginForm");console.error(u)}}return c(),document.addEventListener("visibilitychange",c),()=>{document.removeEventListener("visibilitychange",c)}},[e]),s(k,null,o||{Blank:s("div",null),LoginForm:s(mn,{resort:t,onLogin:c=>{e.setData(c),r("Client")}}),Client:n}[i])}const pt=re({}),hn=pt.Provider,ce=()=>le(pt),gt=re({current:null,begin:()=>null,end:()=>null}),_n=gt.Provider,ue=()=>le(gt),pn=3e3,gn={alert:"bg-yellow-200",error:"bg-red-200"};function we(){const[,t]=b(0),[e,n]=b(""),[i,r]=b("alert"),o=q((c,u)=>{n(c),r(u||"alert"),t(d=>(clearTimeout(d),c?self.setTimeout(()=>{n("")},pn):d))},[]);return[s(yn,{message:e,type:i}),o]}function yn({message:t,type:e}){return t?s("div",{role:"alert",className:`fixed bottom-20 left-0 w-full p-2 font-semibold text-center ${gn[e]} text-gray-800`},t):null}function yt({children:t,className:e}){return e||(e=""),e.match(/\bw-\S+\s*/)||(e+=" w-4"),e.match(/\bh-\S+\s*/)||(e+=" h-auto"),s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 16 16",className:e},t)}/**
 * Refresh icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function xe({className:t}){return s(yt,{className:t},s("path",{d:"M16 6h-6l2.243-2.243c-1.133-1.133-2.64-1.757-4.243-1.757s-3.109 0.624-4.243 1.757c-1.133 1.133-1.757 2.64-1.757 4.243s0.624 3.109 1.757 4.243c1.133 1.133 2.64 1.757 4.243 1.757s3.109-0.624 4.243-1.757c0.095-0.095 0.185-0.192 0.273-0.292l1.505 1.317c-1.466 1.674-3.62 2.732-6.020 2.732-4.418 0-8-3.582-8-8s3.582-8 8-8c2.209 0 4.209 0.896 5.656 2.344l2.343-2.344v6z"}))}async function bt(t){return new Promise(e=>{setTimeout(e,t)})}function bn(){const[t,e]=b(0),n=q(async(r,o=500)=>{e(c=>c+1);const l=bt(o);try{await r()}finally{await l,e(c=>c-1)}},[]);return[t>0?s(vn,null):null,n]}function vn(){const{bg:t}=F();return s(ve,{className:"flex items-center bg-white bg-opacity-75"},s("div",{className:"w-[50px] mx-auto"},s("div",{"aria-label":"Loading\u2026",className:`rounded-full p-[20%] ${t}`},s(xe,{className:"animate-spin w-full text-white"}))))}function ke(){const[t,e]=bn(),n=!!t,[i,r]=we();return{loadData:q(async(c,u)=>{const d=E({error:"Unknown error occurred",request:"Network request failed"},u);r("");let a=()=>null;const m=new Promise(f=>{a=()=>f(null)});async function h(...f){await m,r(...f)}await e(async()=>{try{await c(h)}catch(f){if(f instanceof lt){const{status:_}=f.response;h(_ in d?d[_]:d.request,"error")}else console.error(f),h(d.error,"error")}}),a()},[e,r]),loaderElem:s(k,null,i,t),isLoading:n}}/**
 * Power icon from [IcoMoon]{@link https://icomoon.io/#icons-icomoon}
 * @license CC-BY-4.0
 */function wn({className:t}){return s(yt,{className:t},s("path",{d:"M6 0l-6 8h6l-4 8 14-10h-8l6-6z"}))}function je(t){const r=t,{className:e}=r,n=B(r,["className"]),{bg:i}=F();return s("select",E({className:`${e||""} border-2 border-white rounded-lg px-1 ${i} font-semibold disabled:opacity-50`},n))}function L({guests:t,selectable:e,conflicts:n}){return t.length===0?null:s("ul",{className:"mt-2"},t.map(i=>{var r;return s("li",{key:i.id,className:"px-3 py-1"},s("label",{className:"flex items-center"},e?s("input",{type:"checkbox",checked:e.isSelected(i),onChange:()=>e.onToggle(i),className:"mr-3"}):null,s("span",{className:"w-[48px] h-[48px] leading-[48px] mr-3 rounded-full text-3xl font-bold text-center bg-gray-400 text-white"},i.avatarImageUrl?s("img",{src:i.avatarImageUrl,alt:"",width:"48",height:"48",className:"rounded-full"}):s("span",{"aria-hidden":"true"},i.name[0])),s("span",{className:"leading-tight"},i.name,s("br",null),n!=null&&n[i.id]?s("span",{className:"text-xs font-semibold text-red-700 uppercase"},(r=n[i.id])==null?void 0:r.replace(/_/g," ")):null)))}))}function Ne({times:t}){return s("div",{className:"mt-4 text-lg"},"Arrive by:"," ",s("span",{className:"ml-0.5 font-semibold"},s("time",null,W(t.start.time))," -"," ",t.end.time?s("time",null,W(t.end.time)):"Park Close"))}function xn({booking:t,onClose:e}){const n=ce(),[i,r]=b(new Set),{loadData:o,loaderElem:l}=ke(),{guests:c}=t,u=i.size===0,d=i.size===c.length;function a(){o(async()=>{u||await n.cancelBooking([...i]),e(c.filter(m=>!i.has(m)))})}return s(M,{heading:"Your Lightning Lane",theme:t.park.theme},s("h2",null,t.experience.name),s("div",null,t.park.name),s(Ne,{times:t}),s("div",{className:"ml-3"},s("label",{className:"flex items-center py-4"},s("input",{type:"checkbox",checked:d,onChange:()=>r(new Set(d?[]:c))}),s("span",{className:"ml-3"},"Select All"))),u?null:s("div",{className:"mb-4"},s("h3",null,"Cancel These Guests"),s(L,{guests:c.filter(m=>i.has(m)),selectable:{isSelected:()=>!0,onToggle:m=>{const h=new Set(i);h.delete(m),r(h)}}})),d?null:s("div",null,s("h3",null,"Select Guests to Cancel"),s(L,{guests:c.filter(m=>!i.has(m)),selectable:{isSelected:()=>!1,onToggle:m=>r(new Set(i).add(m))}})),s($,{onClick:a},u?"Back":"Cancel "+(d?"Reservation":"Guests")),l)}function vt({booking:t,onClose:e,isRebookable:n,isNew:i}){const r=ue(),[o,l]=b(t.guests),[c,u]=b(!1);return c?s(xn,{booking:G(E({},t),{guests:o}),onClose:d=>{u(!1),d.length>0?l(d):e(d)}}):s(M,{heading:"Your Lightning Lane",theme:t.park.theme,buttons:n&&s(P,{onClick:()=>r.begin(t)},"Rebook")},s("h2",null,t.experience.name),s("div",null,t.park.name),s(Ne,{times:t}),t.choices&&s(k,null,s("p",null,"An experience you booked was temporarily unavailable during your return time. You may redeem this Lightning Lane at one of these replacement experiences:"),s("ul",{className:"list-disc mt-2 pl-8"},t.choices.map(d=>s("li",{key:d.id},d.name)))),s("div",{className:"flex mt-4"},s("h3",{className:"inline mt-0"},"Your Party"),!t.choices&&s(P,{type:"small",onClick:()=>u(!0),className:"ml-3"},"Cancel")),s(L,{guests:o,conflicts:t.choices&&Object.fromEntries(o.filter(d=>d.redemptions).map(d=>[d.id,`Redemptions left: ${d.redemptions}`]))}),s($,{onClick:()=>e(o)},i?"Done":"Back"))}function wt({guests:t}){return s(L,{guests:t,conflicts:Object.fromEntries(t.map(e=>[e.id,e.displayEligibleAfter?`TOO EARLY (${e.displayEligibleAfter})`:e.ineligibleReason]))})}function kn({offer:t,guests:e,ineligibleGuests:n,onConfirm:i}){const r=ue(),[o,l]=b(new Set(e)),[c,u]=b(!1);return s(k,null,r.current&&s("p",{className:"border-2 rounded border-red-600 p-1 font-semibold text-center text-red-600 bg-red-100"},"Rebooking resets the two hour timer"),s(Ne,{times:t}),t.changeStatus==="PARK_HOPPING"&&s("div",{className:"text-sm"},s("strong",null,"Note:")," Time changed due to park hopping"),c?s(k,null,s("h3",null,"Choose Your Party"),s(L,{guests:e,selectable:{isSelected:d=>o.has(d),onToggle:d=>{const a=new Set(o);a[o.has(d)?"delete":"add"](d),l(a)}}}),n.length>0&&s(k,null,s("h3",null,"Ineligible Guests"),s(wt,{guests:n})),s($,{onClick:()=>u(!1)},"Confirm Party")):s(k,null,s("div",{className:"mt-4"},s("h3",{className:"inline mt-0"},"Your Party"),s("span",null,s(P,{type:"small",onClick:()=>u(!0),className:"ml-3"},"Edit"))),s(L,{guests:e.filter(d=>o.has(d))}),s($,{onClick:()=>i([...o])},r.current?"Rebook":"Book"," Lightning Lane")))}const We="https://widget.time.is/t.js";function Nn(){if([...document.scripts].some(e=>e.src===We))return;const t=document.createElement("script");t.src=We,t.onload=xt,document.head.appendChild(t)}const te={};function xt(){"time_is_widget"in self&&self.time_is_widget.init(te)}function En(t){Nn(),te[t]||(te[t]={}),xt()}function kt(t,e){const n=document.getElementById(t);if(!n||n.firstElementChild)return e();n.textContent=U().time,setTimeout(()=>kt(t,e),100)}function Tn({id:t,onSync:e}){return D(()=>{En(t),kt(t,e)},[t,e]),s("time",{id:t})}const Cn={WDW:"Orlando_z161",DLR:"Anaheim_z14e"},Sn=5e3;function Nt({resort:t,time:e,label:n}){const[i,r]=b(null);D(()=>{setTimeout(()=>r(l=>l||!1),Sn)},[]);const o=q(()=>r(!0),[]);return s("table",{className:"mt-4 mx-auto text-gray-500"},s(Qe,{heading:n,time:s("time",null,e||"--:--:--")}),s(Qe,{heading:s("a",{href:`https://time.is/${t}`,id:"time_is_link",target:"_blank",rel:"noreferrer"},"Current time"),time:s(k,null,s(Tn,{id:Cn[t],onSync:o}),i===!1?s("span",{className:"text-sm font-sans font-semibold text-red-600"}," ","(unsynced)"):null)}))}function Qe({heading:t,time:e}){return s("tr",null,s("th",{scope:"row",className:"pr-3 text-right text-xs font-semibold uppercase"},t,":"),s("td",{className:"text-xl font-mono leading-tight"},"\uFEFF",e))}function In({startTime:t,onRefresh:e}){return s(k,null,t&&s(Nt,{resort:"WDW",time:t,label:"Booking start"}),s("h3",{className:"mt-4"},"Not Available Yet"),t?s("p",null,"At"," ",s("time",{dateTime:t,className:"font-semibold"},W(t)),", tap the ",s("span",{className:"font-semibold"},"Check Availability")," ","button below to start booking this Lightning Lane."):s("p",null,"Sorry, but you can't make a Lightning Lane reservation for this attraction yet."),s($,{onClick:e},"Check Availability"))}function An({guests:t,onClose:e}){var i;const n=(i=t==null?void 0:t[0])==null?void 0:i.displayEligibleAfter;return s(k,null,n&&s("div",{className:"mt-4 border-2 border-green-600 rounded p-1 uppercase font-semibold text-center text-green-600 bg-green-100"},"Eligible at ",n),s("h3",{className:"mt-4"},"No Eligible Guests"),s("p",null,"No one in your party is currently eligible for this Lightning Lane."),s(wt,{guests:t}),s($,{onClick:e},"Back"))}function Dn({onClose:t}){return s(k,null,s("h3",null,"No Reservations Available"),s("p",null,"Tap the refresh button above to try again or go back to the tip board and select another attraction."),s($,{onClick:t},"Back"))}function Et({booking:t,button:e}){return s("div",{className:"flex items-center gap-x-2"},s("div",{className:"flex-1 min-w-0"},s("div",{className:"text-gray-500 text-sm font-semibold uppercase"},s("time",null,W(t.start.time))," -"," ",t.end.time?s("time",null,W(t.end.time)):"close"),s("div",{className:"text-lg font-semibold leading-tight truncate"},t.experience.name)),e&&s("div",null,e))}function Tt(){const t=ue(),e=F();return t.current?s("div",{className:`sticky top-0 -mx-3 pb-1 ${e.bg}`},s("div",{className:"pb-3 bg-white"},s("div",{className:`py-1.5 ${e.bg} text-white text-sm font-semibold uppercase text-center`},"Rebooking"),s("div",{className:"mt-2 px-3"},s(Et,{booking:t.current,button:s(P,{type:"small",onClick:()=>t.end(!0)},"Keep")})))):null}function Rn({experience:t,park:e,onClose:n}){const i=ce(),r=ue(),[o,l]=b(),[c,u]=b([]),[d,a]=b(t.flex.available),[m,h]=b(d?void 0:null),[f,_]=b(),{loadData:T,loaderElem:v}=ke();async function y(w){if(!m)return;let A=null;await T(async()=>{const x=new Set(w.map(S=>S.id));r.current&&await i.cancelBooking(r.current.guests.filter(S=>x.has(S.id)));try{A=await i.book(m)}finally{r.end()}const I=A.guests.filter(S=>!x.has(S.id));I.length>0&&(await i.cancelBooking(I),A.guests=A.guests.filter(S=>x.has(S.id)))},{410:"Offer expired"}),A&&_(A)}function N(){T(async w=>{const x=(await i.plusExperiences(e)).find(I=>I.id===t.id);x!=null&&x.flex.available?(a(!0),h(void 0)):w("Reservations not open yet")})}function C(){m&&i.cancelOffer(m),n()}function p(){!o||o.length===0||T(async()=>{const w=await i.offer({experience:t,park:e,guests:o});h(A=>(A&&i.cancelOffer(A),w))},{410:"No reservations available"})}return D(()=>{o||T(async()=>{const{guests:w,ineligibleGuests:A}=await i.guests({experience:t,park:e}),x=r.current;if(x){const I=new Set(A.filter(O=>O.ineligibleReason==="TOO_EARLY"||O.ineligibleReason==="EXPERIENCE_LIMIT_REACHED"&&t.id===x.experience.id).map(O=>O.id)),S=x.guests.every(O=>I.has(O.id));l(S?x.guests:[]);const Rt=new Set(x.guests.map(O=>O.id));u(S?[]:A.filter(O=>Rt.has(O.id)))}else l(w),u(A)})},[i,t,e,o,r,T]),D(()=>{m!==void 0||!o||o.length===0||T(async()=>{try{h(await i.offer({experience:t,park:e,guests:o}))}catch(w){throw h(null),w}},{410:""})},[i,t,e,o,m,T]),f?s(vt,{booking:f,onClose:n,isNew:!0}):s(M,{heading:"Lightning Lane",theme:e.theme,buttons:s(k,null,(!d||m)&&s(P,{onClick:C},"Cancel"),d&&o&&o.length>0&&s(P,{onClick:p,title:"Refresh Offer"},s(xe,null)))},s(Tt,null),s("h2",null,t.name),s("div",null,e.name),(o==null?void 0:o.length)===0?s(An,{guests:c,onClose:n}):!o||m===void 0?s("div",null):d?m===null?s(Dn,{onClose:n}):s(kn,{offer:m,guests:o,ineligibleGuests:c,onConfirm:y}):s(In,{startTime:t.flex.enrollmentStartTime,onRefresh:N}),v)}function Pn({onClose:t}){const e=ce(),[n,i]=b(),[r,o]=b(),[l,c]=b(!1);function u(a){!r||(i(m=>{if(!!m)return a.length>0?r.guests=a:m.splice(m.indexOf(r),1),m}),o(void 0))}D(()=>{c(!0),e.bookings().then(a=>i(a))},[e]);function d(){c(!1),setTimeout(t,300)}return r?s(vt,{booking:r,onClose:u,isRebookable:e.isRebookable(r)}):s(k,null,s(ve,{onClick:d,"data-testid":"panel-shade",className:"bg-black bg-opacity-75"}),s(M,{heading:"Your Lightning Lanes",buttons:s(P,{onClick:d},"Close"),className:`top-auto max-h-[50%] ${l?"h-[275px]":"h-0"} duration-200 ease-linear`},n&&n.length>0?s("ul",null,(n||[]).map(a=>{var m;return s("li",{className:"py-3 first:border-0 border-t-4 border-gray-300",key:(m=a.guests[0])==null?void 0:m.entitlementId},s(Et,{booking:a,button:s(P,{type:"small",onClick:()=>o(a)},"More")}))})):s("div",{className:"mt-4 text-sm font-semibold text-center uppercase  text-gray-500"},n&&"No current reservations")))}function Ee({label:t,children:e}){return s("div",{className:"flex items-center flex-1 whitespace-nowrap"},s("span",{className:"mr-2 text-xs font-semibold uppercase text-gray-500"},t)," ",e)}function Ln({experience:t,onClick:e}){const{flex:n}=t;return s(Ee,{label:"Genie+"},n.nextAvailableTime?s("span",null,s(P,{onClick:()=>e(t)},W(n.nextAvailableTime))):s("span",{className:"inline-block border-2 border-gray-500 rounded px-1.5 py-0.5 font-semibold text-gray-500 bg-gray-100"},"none"))}function $n({experience:{type:t,standby:e}}){return e.displayNextShowTime||t==="ENTERTAINMENT"&&!e.waitTime?s(Gn,{standby:e}):s(On,{standby:e})}const On=({standby:t})=>s(Ee,{label:"Standby"},t.available?s(St,{time:t.waitTime!==void 0?t.waitTime+" min":"now"}):s(It,{text:"down"})),Gn=({standby:t})=>s(Ee,{label:s(k,null,"Next ",s("span",{className:"hidden xs:inline"},"Show"))},t.displayNextShowTime?s(St,{time:t.displayNextShowTime}):s(It,{text:"none"})),Ct="inline-block border-2 rounded px-1.5 py-0.5 font-semibold",St=({time:t})=>s("span",{className:`${Ct} border-gray-500 text-gray-500 bg-gray-100`},t),It=({text:t})=>s("span",{className:`${Ct} border-red-600 text-red-600 bg-red-100`},t),Mn=6e4,Bn=(t,e)=>(t.priority||1/0)-(e.priority||1/0),de=(t,e)=>(e.standby.waitTime||-1)-(t.standby.waitTime||-1),me=(t,e)=>(t.flex.nextAvailableTime||"").localeCompare(e.flex.nextAvailableTime||""),Un=(t,e)=>t.name.toLowerCase().localeCompare(e.name.toLowerCase()),Hn={priority:(t,e)=>Bn(t,e)||de(t,e)||me(t,e),standby:(t,e)=>de(t,e)||me(t,e),soonest:(t,e)=>me(t,e)||de(t,e),aToZ:()=>0};function Fn(){const t=ce(),{parks:e}=t,[n,i]=b(e[0]),[r,o]=b([]),[l,c]=b(),[u,d]=b(!1),[a,m]=b("priority"),{loadData:h,loaderElem:f,isLoading:_}=ke(),[,T]=b(0),[v,y]=b(()=>({current:null,begin:p=>{y(G(E({},v),{current:p})),i(p.park),d(!1)},end:(p=!1)=>{y(w=>w.current?G(E({},w),{current:null}):w),p&&c(void 0)}})),N=be(null),C=q((p=!0)=>{T(w=>!p&&Date.now()-w<Mn?w:(h(async()=>o(await t.plusExperiences(n))),Date.now()))},[t,n,h]);return D(()=>{o([]),C()},[C]),D(()=>{if(_||l||u)return;const p=()=>{document.hidden||C(!1)};return document.addEventListener("visibilitychange",p),()=>{document.removeEventListener("visibilitychange",p)}},[l,C,_,u]),D(()=>{var p;(p=N.current)==null||p.scroll(0,0)},[n,a,v]),s(_n,{value:v},s(M,{heading:s(k,null,"G",s("span",{className:"hidden xs:inline"},"enie"),"+"),theme:n.theme,buttons:s(k,null,s(P,{onClick:()=>d(!0),title:"Your Lightning Lanes"},s(wn,null)),s(je,{value:n.id,onChange:p=>{i(e.find(w=>w.id===p.currentTarget.value))},title:"Park"},e.map(p=>s("option",{value:p.id,title:p.name,key:p.id},p.abbr))),s(je,{value:a,onChange:p=>m(p.currentTarget.value),title:"Sort By"},s("option",{value:"priority"},"Priority"),s("option",{value:"standby"},"Standby"),s("option",{value:"soonest"},"Soonest"),s("option",{value:"aToZ"},"A to Z")),s(P,{onClick:C,title:"Refresh Tip Board"},s(xe,null))),containerRef:N},s("div",{"aria-hidden":!!(l||u)},s(Tt,null),s("ul",null,r.sort((p,w)=>+w.flex.available-+p.flex.available||Hn[a](p,w)||Un(p,w)).map(p=>s("li",{className:"pb-3 first:border-0 border-t-4 border-gray-300",key:p.id},s("h2",{className:"text-lg leading-tight truncate"},p.name),p.flex.preexistingPlan?s("div",{className:"mt-2 border-2 border-green-600 rounded p-1 text-sm uppercase font-semibold text-center text-green-600 bg-green-100"},"Lightning Lane Booked"):null,s("div",{className:"flex flex-wrap gap-1.5 mt-2"},s($n,{experience:p}),s(Ln,{experience:p,onClick:c}))))),f)),u&&s(Pn,{onClose:()=>d(!1)}),l&&s(Rn,{experience:l,park:n,onClose:()=>{C(!1),c(void 0)}}))}const At=re({}),jn=At.Provider,Wn=()=>le(At),Qn={success:5e3,failure:1e3};function Yn({guests:t,result:e,onDone:n}){const{boardingGroup:i,conflicts:r}=e,o=t.filter(d=>!(d.id in r)),l=t.filter(d=>d.id in r),[c,u]=b(!0);return D(()=>{setTimeout(()=>u(!1),Qn[i?"success":"failure"])},[i]),s(k,null,i?s(k,null,s("h2",{className:"mt-5 text-xl"},"Boarding Group: ",i),s(L,{guests:o}),Object.keys(r).length>0?s(k,null,s("p",{className:"font-semibold"},"These guests could not join:"),s(L,{guests:l,conflicts:r})):null,s("p",null,"Refer to the My Disney Experience app for return time and other information.")):s(k,null,s("h2",{className:"mt-5 text-xl"},"Sorry!"),s("p",null,"A boarding group could not be obtained."),s(L,{guests:l,conflicts:r})),c?null:s($,{onClick:n},"Done"))}function Jn({guests:t,party:e,onToggle:n,onConfirm:i}){return s(k,null,s("h2",{className:"mt-5 text-xl"},"Choose Your Party"),t.length>0?s(L,{guests:t,selectable:{isSelected:r=>e.has(r),onToggle:n}}):s("p",null,"No guests available"),s($,{disabled:e.size===0,onClick:i},"Confirm Party"))}function qn({queue:t}){return s(k,null,t.howToEnterMessage.split(`

`).map((e,n)=>s("p",{key:n},e)))}const zn=999;function Kn({guests:t,joinQueue:e,onEdit:n}){const[i,r]=b(!1),[o,l]=we(),{bg:c}=F();async function u(){r(!0),l("");const d=bt(zn);try{await e()||l("Queue not open yet")}catch(a){l("Error: try again","error"),a instanceof Z||console.error(a)}finally{await d,r(!1)}}return s(k,null,s("div",{className:"mt-4"},s("h2",{className:"inline text-xl"},"Your Party"),s("span",null,s("button",{onClick:n,className:`ml-3 px-2 py-1.5 rounded-lg ${c} text-white text-xs uppercase font-semibold tracking-wide align-middle`},"Edit"))),s(L,{guests:t}),s($,{disabled:i,onClick:u},"Join Boarding Group"),o)}function Vn({queue:t,queues:e,onChange:n}){e||(e=[]);const{bg:i}=F(),r=`block w-full ${i} text-white text-xl font-semibold`;return s(k,null,e.length<=1?s("span",{className:`${r} px-1 truncate`},t.name):s("select",{className:`${r} pr-1`,onChange:o=>n?n(o.currentTarget.value):null},e.map(o=>s("option",{selected:o===t,key:o.id,value:o.id,className:"text-base font-normal"},o.name))))}function Xn(){const t=Wn(),[e,n]=b(),[i,r]=b(null),[o,l]=b([]),[c,u]=b(new Set),[d,a]=b({boardingGroup:null,conflicts:{},closed:!0}),[m,h]=b("ChooseParty"),[f,_]=we(),T=be(null);D(()=>{(async()=>{const x=await t.getQueues();n(x),r(x[0])})()},[t]),D(()=>{if(!i)return;let x=!1;return(async()=>{const I=await t.getLinkedGuests(i);x||(l(I),u(new Set(I.filter(S=>S.isPreselected))))})(),()=>{x=!0}},[t,i]),D(()=>{var x;(x=T.current)==null||x.scroll(0,0)},[m]);function v(x){const I=new Set(c);I[I.has(x)?"delete":"add"](x);const S=Number(i==null?void 0:i.maxPartySize);S>0&&I.size>S?_(`Max party size: ${S}`,"error"):(u(I),_(""))}function y(x){const I=e==null?void 0:e.find(S=>S.id===x);I&&r(I)}async function N(){return!i||!(await t.getQueue(i)).isAcceptingJoins?!1:(a(await t.joinQueue(i,[...c])),h("BGResult"),!0)}if((e==null?void 0:e.length)===0)return s(M,{heading:"No Virtual Queues"},s("p",null,"The virtual queue system is not currently in use for any attractions."));if(!i)return s("div",null);const C=o.filter(x=>c.has(x)),p=s(Nt,{resort:t.resort,time:i.nextScheduledOpenTime,label:"Next queue opening"}),w=s(Vn,{queue:i,queues:m==="ChooseParty"?e:[],onChange:y});return{ChooseParty:s(M,{heading:w,containerRef:T},s(qn,{queue:i}),p,s(Jn,{guests:o,party:c,onToggle:v,onConfirm:()=>h("JoinQueue")}),f),JoinQueue:s(M,{heading:w},p,s(Kn,{guests:C,onEdit:()=>h("ChooseParty"),joinQueue:N})),BGResult:s(M,{heading:w},s(Yn,{guests:C,result:d,onDone:()=>h("ChooseParty")}))}[m]}const Dt=new Ft("bg1.auth"),Ye=()=>Dt.getData();Kt(origin)?Je(new Xt({origin,getAuthData:Ye}),Xn,jn):qt(origin)?ye.load({origin,getAuthData:Ye}).then(t=>Je(t,Fn,hn)):location.href="https://joelface.github.io/bg1/start.html";async function Je(t,e,n){document.head.innerHTML+=`
    <meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>BG1</title>
  `,Ht({WDW:"America/New_York",DLR:"America/Los_Angeles"}[t.resort]),Ut(s(fn,{resort:t.resort,authStore:Dt},s(n,{value:t},s(e,null))),document.body),Zn()}function Zn(){document.body.addEventListener("click",()=>null)}
