var e,t,n,o,r,s,i=Object.defineProperty,l=Object.defineProperties,u=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,_=Object.prototype.propertyIsEnumerable,d=(e,t,n)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f=(e,t)=>{for(var n in t||(t={}))c.call(t,n)&&d(e,n,t[n]);if(a)for(var n of a(t))_.call(t,n)&&d(e,n,t[n]);return e},h={},p=[],m=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function g(e,t){for(var n in t)e[n]=t[n];return e}function y(e){var t=e.parentNode;t&&t.removeChild(e)}function v(t,n,o){var r,s,i,l={};for(i in n)"key"==i?r=n[i]:"ref"==i?s=n[i]:l[i]=n[i];if(arguments.length>2&&(l.children=arguments.length>3?e.call(arguments,2):o),"function"==typeof t&&null!=t.defaultProps)for(i in t.defaultProps)void 0===l[i]&&(l[i]=t.defaultProps[i]);return b(t,l,r,s,null)}function b(e,o,r,s,i){var l={type:e,props:o,key:r,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++n:i};return null!=t.vnode&&t.vnode(l),l}function k(e){return e.children}function w(e,t){this.props=e,this.context=t}function x(e,t){if(null==t)return e.__?x(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?x(e):null}function N(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return N(e)}}function S(e){(!e.__d&&(e.__d=!0)&&o.push(e)&&!P.__r++||s!==t.debounceRendering)&&((s=t.debounceRendering)||r)(P)}function P(){for(var e;P.__r=o.length;)e=o.sort((function(e,t){return e.__v.__b-t.__v.__b})),o=[],e.some((function(e){var t,n,o,r,s,i;e.__d&&(s=(r=(t=e).__v).__e,(i=t.__P)&&(n=[],(o=g({},r)).__v=r.__v+1,O(i,r,o,t.__n,void 0!==i.ownerSVGElement,null!=r.__h?[s]:null,n,null==s?x(r):s,r.__h),G(n,r),r.__e!=s&&N(r)))}))}function C(e,t,n,o,r,s,i,l,u,a){var c,_,d,f,m,g,y,v=o&&o.__k||p,w=v.length;for(n.__k=[],c=0;c<t.length;c++)if(null!=(f=n.__k[c]=null==(f=t[c])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?b(null,f,null,null,f):Array.isArray(f)?b(k,{children:f},null,null,null):f.__b>0?b(f.type,f.props,f.key,null,f.__v):f)){if(f.__=n,f.__b=n.__b+1,null===(d=v[c])||d&&f.key==d.key&&f.type===d.type)v[c]=void 0;else for(_=0;_<w;_++){if((d=v[_])&&f.key==d.key&&f.type===d.type){v[_]=void 0;break}d=null}O(e,f,d=d||h,r,s,i,l,u,a),m=f.__e,(_=f.ref)&&d.ref!=_&&(y||(y=[]),d.ref&&y.push(d.ref,null,f),y.push(_,f.__c||m,f)),null!=m?(null==g&&(g=m),"function"==typeof f.type&&null!=f.__k&&f.__k===d.__k?f.__d=u=E(f,u,e):u=I(e,f,d,v,m,u),a||"option"!==n.type?"function"==typeof n.type&&(n.__d=u):e.value=""):u&&d.__e==u&&u.parentNode!=e&&(u=x(d))}for(n.__e=g,c=w;c--;)null!=v[c]&&("function"==typeof n.type&&null!=v[c].__e&&v[c].__e==n.__d&&(n.__d=x(o,c+1)),U(v[c],v[c]));if(y)for(c=0;c<y.length;c++)L(y[c],y[++c],y[++c])}function E(e,t,n){var o,r;for(o=0;o<e.__k.length;o++)(r=e.__k[o])&&(r.__=e,t="function"==typeof r.type?E(r,t,n):I(n,r,r,e.__k,r.__e,t));return t}function I(e,t,n,o,r,s){var i,l,u;if(void 0!==t.__d)i=t.__d,t.__d=void 0;else if(null==n||r!=s||null==r.parentNode)e:if(null==s||s.parentNode!==e)e.appendChild(r),i=null;else{for(l=s,u=0;(l=l.nextSibling)&&u<o.length;u+=2)if(l==r)break e;e.insertBefore(r,s),i=s}return void 0!==i?i:r.nextSibling}function T(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||m.test(t)?n:n+"px"}function q(e,t,n,o,r){var s;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof o&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||T(e.style,t,"");if(n)for(t in n)o&&n[t]===o[t]||T(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])s=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?o||e.addEventListener(t,s?A:D,s):e.removeEventListener(t,s?A:D,s);else if("dangerouslySetInnerHTML"!==t){if(r)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(i){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function D(e){this.l[e.type+!1](t.event?t.event(e):e)}function A(e){this.l[e.type+!0](t.event?t.event(e):e)}function O(n,o,r,s,i,l,u,a,c){var _,d,f,p,m,v,b,N,S,P,E,I=o.type;if(void 0!==o.constructor)return null;null!=r.__h&&(c=r.__h,a=o.__e=r.__e,o.__h=null,l=[a]),(_=t.__b)&&_(o);try{e:if("function"==typeof I){if(N=o.props,S=(_=I.contextType)&&s[_.__c],P=_?S?S.props.value:_.__:s,r.__c?b=(d=o.__c=r.__c).__=d.__E:("prototype"in I&&I.prototype.render?o.__c=d=new I(N,P):(o.__c=d=new w(N,P),d.constructor=I,d.render=j),S&&S.sub(d),d.props=N,d.state||(d.state={}),d.context=P,d.__n=s,f=d.__d=!0,d.__h=[]),null==d.__s&&(d.__s=d.state),null!=I.getDerivedStateFromProps&&(d.__s==d.state&&(d.__s=g({},d.__s)),g(d.__s,I.getDerivedStateFromProps(N,d.__s))),p=d.props,m=d.state,f)null==I.getDerivedStateFromProps&&null!=d.componentWillMount&&d.componentWillMount(),null!=d.componentDidMount&&d.__h.push(d.componentDidMount);else{if(null==I.getDerivedStateFromProps&&N!==p&&null!=d.componentWillReceiveProps&&d.componentWillReceiveProps(N,P),!d.__e&&null!=d.shouldComponentUpdate&&!1===d.shouldComponentUpdate(N,d.__s,P)||o.__v===r.__v){d.props=N,d.state=d.__s,o.__v!==r.__v&&(d.__d=!1),d.__v=o,o.__e=r.__e,o.__k=r.__k,o.__k.forEach((function(e){e&&(e.__=o)})),d.__h.length&&u.push(d);break e}null!=d.componentWillUpdate&&d.componentWillUpdate(N,d.__s,P),null!=d.componentDidUpdate&&d.__h.push((function(){d.componentDidUpdate(p,m,v)}))}d.context=P,d.props=N,d.state=d.__s,(_=t.__r)&&_(o),d.__d=!1,d.__v=o,d.__P=n,_=d.render(d.props,d.state,d.context),d.state=d.__s,null!=d.getChildContext&&(s=g(g({},s),d.getChildContext())),f||null==d.getSnapshotBeforeUpdate||(v=d.getSnapshotBeforeUpdate(p,m)),E=null!=_&&_.type===k&&null==_.key?_.props.children:_,C(n,Array.isArray(E)?E:[E],o,r,s,i,l,u,a,c),d.base=o.__e,o.__h=null,d.__h.length&&u.push(d),b&&(d.__E=d.__=null),d.__e=!1}else null==l&&o.__v===r.__v?(o.__k=r.__k,o.__e=r.__e):o.__e=function(t,n,o,r,s,i,l,u){var a,c,_,d=o.props,f=n.props,p=n.type,m=0;if("svg"===p&&(s=!0),null!=i)for(;m<i.length;m++)if((a=i[m])&&(a===t||(p?a.localName==p:3==a.nodeType))){t=a,i[m]=null;break}if(null==t){if(null===p)return document.createTextNode(f);t=s?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,f.is&&f),i=null,u=!1}if(null===p)d===f||u&&t.data===f||(t.data=f);else{if(i=i&&e.call(t.childNodes),c=(d=o.props||h).dangerouslySetInnerHTML,_=f.dangerouslySetInnerHTML,!u){if(null!=i)for(d={},m=0;m<t.attributes.length;m++)d[t.attributes[m].name]=t.attributes[m].value;(_||c)&&(_&&(c&&_.__html==c.__html||_.__html===t.innerHTML)||(t.innerHTML=_&&_.__html||""))}if(function(e,t,n,o,r){var s;for(s in n)"children"===s||"key"===s||s in t||q(e,s,null,n[s],o);for(s in t)r&&"function"!=typeof t[s]||"children"===s||"key"===s||"value"===s||"checked"===s||n[s]===t[s]||q(e,s,t[s],n[s],o)}(t,f,d,s,u),_)n.__k=[];else if(m=n.props.children,C(t,Array.isArray(m)?m:[m],n,o,r,s&&"foreignObject"!==p,i,l,i?i[0]:o.__k&&x(o,0),u),null!=i)for(m=i.length;m--;)null!=i[m]&&y(i[m]);u||("value"in f&&void 0!==(m=f.value)&&(m!==t.value||"progress"===p&&!m)&&q(t,"value",m,d.value,!1),"checked"in f&&void 0!==(m=f.checked)&&m!==t.checked&&q(t,"checked",m,d.checked,!1))}return t}(r.__e,o,r,s,i,l,u,c);(_=t.diffed)&&_(o)}catch(T){o.__v=null,(c||null!=l)&&(o.__e=a,o.__h=!!c,l[l.indexOf(a)]=null),t.__e(T,o,r)}}function G(e,n){t.__c&&t.__c(n,e),e.some((function(n){try{e=n.__h,n.__h=[],e.some((function(e){e.call(n)}))}catch(o){t.__e(o,n.__v)}}))}function L(e,n,o){try{"function"==typeof e?e(n):e.current=n}catch(r){t.__e(r,o)}}function U(e,n,o){var r,s;if(t.unmount&&t.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||L(r,null,n)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(i){t.__e(i,n)}r.base=r.__P=null}if(r=e.__k)for(s=0;s<r.length;s++)r[s]&&U(r[s],n,"function"!=typeof e.type);o||null==e.__e||y(e.__e),e.__e=e.__d=void 0}function j(e,t,n){return this.constructor(e,n)}e=p.slice,t={__e:function(e,t){for(var n,o,r;t=t.__;)if((n=t.__c)&&!n.__)try{if((o=n.constructor)&&null!=o.getDerivedStateFromError&&(n.setState(o.getDerivedStateFromError(e)),r=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),r=n.__d),r)return n.__E=n}catch(s){e=s}throw e}},n=0,w.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=g({},this.state),"function"==typeof e&&(e=e(g({},n),this.props)),e&&g(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),S(this))},w.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),S(this))},w.prototype.render=k,o=[],r="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,P.__r=0;function H(e){e=e||new Date;const t={},n="2-digit";Intl.DateTimeFormat("en-US",{timeZone:"America/New_York",hourCycle:"h23",year:"numeric",month:n,day:n,hour:n,minute:n,second:n}).formatToParts(e).forEach((e=>t[e.type]=e.value));const o=e.getMilliseconds().toString().padStart(3,"0");return{date:`${t.year}-${t.month}-${t.day}`,time:`${t.hour}:${t.minute}:${t.second}.${o}`}}class M extends Error{constructor(e){super(`Token "${e}" missing or expired`),this.name="TokenStale"}}function B(e){return"https://vqguest-svc-wdw.wdprapps.disney.com/application/v1/guest/"+e}class Q extends Error{constructor(e,t="Request failed"){super(`${t}: ${JSON.stringify(e)}`),this.responseData=e,this.name="RequestError"}}var $,F,W,R=0,J=[],V=t.__b,z=t.__r,Y=t.diffed,K=t.__c,Z=t.unmount;function X(e,n){t.__h&&t.__h(F,e,R||n),R=0;var o=F.__H||(F.__H={__:[],__h:[]});return e>=o.__.length&&o.__.push({}),o.__[e]}function ee(e){return R=1,function(e,t,n){var o=X($++,2);return o.t=e,o.__c||(o.__=[n?n(t):ue(void 0,t),function(e){var t=o.t(o.__[0],e);o.__[0]!==t&&(o.__=[t,o.__[1]],o.__c.setState({}))}],o.__c=F),o.__}(ue,e)}function te(e,n){var o=X($++,3);!t.__s&&le(o.__H,n)&&(o.__=e,o.__H=n,F.__H.__h.push(o))}function ne(e){return R=5,function(e,t){var n=X($++,7);return le(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}((function(){return{current:e}}),[])}function oe(){J.forEach((function(e){if(e.__P)try{e.__H.__h.forEach(se),e.__H.__h.forEach(ie),e.__H.__h=[]}catch(Oe){e.__H.__h=[],t.__e(Oe,e.__v)}})),J=[]}t.__b=function(e){F=null,V&&V(e)},t.__r=function(e){z&&z(e),$=0;var t=(F=e.__c).__H;t&&(t.__h.forEach(se),t.__h.forEach(ie),t.__h=[])},t.diffed=function(e){Y&&Y(e);var n=e.__c;n&&n.__H&&n.__H.__h.length&&(1!==J.push(n)&&W===t.requestAnimationFrame||((W=t.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(o),re&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,100);re&&(t=requestAnimationFrame(n))})(oe)),F=void 0},t.__c=function(e,n){n.some((function(e){try{e.__h.forEach(se),e.__h=e.__h.filter((function(e){return!e.__||ie(e)}))}catch(je){n.some((function(e){e.__h&&(e.__h=[])})),n=[],t.__e(je,e.__v)}})),K&&K(e,n)},t.unmount=function(e){Z&&Z(e);var n=e.__c;if(n&&n.__H)try{n.__H.__.forEach(se)}catch(o){t.__e(o,n.__v)}};var re="function"==typeof requestAnimationFrame;function se(e){var t=F;"function"==typeof e.__c&&e.__c(),F=t}function ie(e){var t=F;e.__c=e.__(),F=t}function le(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function ue(e,t){return"function"==typeof t?t(e):t}function ae({onClick:e,disabled:t,href:n,children:o}){return v("div",{className:"mb-20"},v("div",{className:"fixed bottom-0 left-0 w-full bg-gray-50 bg-opacity-75 text-center"},v("a",{href:n,className:"block max-w-2xl mx-auto px-3 pb-5"},v("button",{onClick:e,disabled:t,className:"w-full p-3 rounded-lg bg-blue-500 text-white font-semibold focus:outline-none focus:ring focus:ring-blue-600 focus:ring-offset-2 disabled:bg-gray-400"},o))))}function ce({guests:e,selectable:t,conflicts:n}){return v("ul",{className:"mt-3 ml-3"},e.map(((e,o)=>v("li",{key:e.guestId,className:"py-1.5 leading-tight"},v("label",{className:"flex items-center"},t?v("input",{type:"checkbox",checked:t.isSelected(o),onChange:()=>t.onToggle(o),className:"rounded mr-4 p-2.5 text-green-500"}):null,v("img",{src:e.avatarImageUrl,alt:"",width:"56",height:"56",className:"rounded-full mr-3"}),v("span",null,e.firstName," ",e.lastName,v("br",null),n&&e.guestId in n?v("span",{className:"text-xs font-semibold text-red-700"},n[e.guestId].replace(/_/g," ")):null))))))}function _e({guests:e,party:t,onToggle:n,onConfirm:o}){return v(k,null,v("h2",{className:"mt-5 text-xl"},"Choose Your Party"),v(ce,{guests:e,selectable:{isSelected:e=>!!t[e],onToggle:n}}),v(ae,{disabled:0===Object.keys(t).length,onClick:o},"Confirm Party"))}function de({message:e,type:t}){t||(t="alert");return e?v("div",{role:"alert",className:`fixed bottom-20 left-0 w-full p-2 font-semibold text-center ${{alert:"bg-yellow-200",error:"bg-red-200"}[t]} text-gray-800`},e):null}function fe({guests:e,joinQueue:t,onEdit:n}){const[o,r]=ee(!1),[s,i]=function(){const[e,t]=ee(0),[n,o]=ee({message:"",type:"alert"});return[n,function(n,r){clearTimeout(e),o({message:n,type:r}),n&&t(self.setTimeout((()=>{o({message:"",type:r})}),2500))}]}();return v(k,null,v("div",{className:"mt-5 text-xl"},v("h2",{className:"inline"},"Your Party"),v("span",null,v("button",{onClick:n,className:"ml-3 px-2 py-1.5 rounded-lg bg-blue-500 text-white text-xs uppercase font-semibold tracking-wide align-middle focus:outline-none focus:ring focus:ring-blue-600 focus:ring-offset-2"},"Edit"))),v(ce,{guests:e}),v(ae,{disabled:o,onClick:async function(){r(!0),i("");const e=async function(e){return new Promise((t=>{setTimeout(t,e)}))}(999);try{await t()||i("Queue not open yet")}catch(n){throw i("Error: try again","error"),n}finally{await e,r(!1)}}},"Join Boarding Group"),v(de,f({},s)))}function he({queue:e,queues:t,onChange:n}){return t||(t=[]),v("h1",{className:"border-b-2 border-gray-200 text-xl font-semibold"},t.length<=1?v("span",{className:"inline-block p-1 w-full whitespace-nowrap overflow-hidden overflow-ellipsis"},e.name):v("select",{className:"w-full border-none p-1 bg-transparent text-xl font-semibold focus:ring-0",onChange:e=>n?n(e.currentTarget.value):null},t.map((t=>v("option",{selected:t===e,key:t.queueId,value:t.queueId,className:"text-base font-normal"},t.name)))))}function pe({guests:e,result:t,onDone:n}){const{boardingGroup:o,conflicts:r}=t,s=e.filter((e=>!(e.guestId in r))),i=e.filter((e=>e.guestId in r));return v(k,null,o?v(k,null,v("h2",{className:"mt-5 text-xl"},"Boarding Group: ",o),v(ce,{guests:s}),Object.keys(r).length>0?v(k,null,v("p",{className:"font-semibold"},"These guests could not join:"),v(ce,{guests:i,conflicts:r})):null,v("p",null,"Refer to the My Disney Experience app for return time and other information.")):v(k,null,v("h2",{className:"mt-5 text-xl"},"Sorry!"),v("p",null,"A boarding group could not be obtained."),v(ce,{guests:i,conflicts:r})),v(ae,{onClick:n},"Done"))}const me={};function ge(){"time_is_widget"in self&&self.time_is_widget.init(me)}function ye(e){!function(){if([...document.scripts].some((e=>"https://widget.time.is/t.js"===e.src)))return;const e=document.createElement("script");e.src="https://widget.time.is/t.js",e.onload=ge,document.head.appendChild(e)}(),me[e]={},ge()}function ve(e){const t=document.getElementById(e);t&&!t.firstElementChild&&(t.textContent=H().time.slice(0,8),setTimeout((()=>ve(e)),100))}function be(){const e="_z161";return te((()=>(ye(e),ve(e),()=>function(e){delete me[e],ge()}(e))),[e]),v("time",{id:e})}function ke({queue:e}){return v("table",{className:"mt-4 mx-auto text-gray-500"},v(we,{heading:"Next queue opening",time:v("time",null,e.nextScheduledOpenTime||"07:00:00")}),v(we,{heading:v("a",{href:"https://time.is/Orlando",id:"time_is_link",target:"_blank",rel:"noreferrer"},"Current time"),time:v(be,null)}))}function we({heading:e,time:t}){return v("tr",null,v("th",{className:"pr-3 text-right text-xs font-semibold uppercase"},e,":"),v("td",{className:"text-xl font-mono leading-tight"},"\ufeff",t))}function xe({queue:e}){return v(k,null,e.howToEnterMessage.split("\n\n").map(((e,t)=>v("p",{key:t},e))))}function Ne({client:e}){const[t,n]=ee([]),[o,r]=ee(null),[s,i]=ee([]),[l,u]=ee([]),[a,c]=ee({boardingGroup:null,conflicts:{},closed:!0}),[_,d]=ee("ChooseParty");if(te((()=>{(async()=>{const t=await e.getQueues();n(t),r(t[0])})()}),[e]),te((()=>{if(!o)return;let t=!1;return(async()=>{var n;const r=await e.getLinkedGuests(o);if(!t){i(r);const e=[];for(let t=0;null==(n=r[t])?void 0:n.isPreselected;++t)e[t]=r[t];u(e)}})(),()=>{t=!0}}),[e,o]),te((()=>scrollTo(0,0)),[_]),!o||0===s.length)return null;return{ChooseParty:v(k,null,v(he,{queue:o,queues:t,onChange:function(e){const n=t.find((t=>t.queueId===e));n&&r(n)}}),v(xe,{queue:o}),v(ke,{queue:o}),v(_e,{guests:s,party:l,onToggle:function(e){const t=l.slice();t[e]?delete t[e]:t[e]=s[e],u(t)},onConfirm:()=>d("JoinQueue")})),JoinQueue:v(k,null,v(he,{queue:o}),v(ke,{queue:o}),v(fe,{guests:Object.values(l),onEdit:()=>d("ChooseParty"),joinQueue:async function(){return!(!o||!(await e.getQueue(o)).isAcceptingJoins)&&(c(await e.joinQueue(o,Object.values(l))),d("BGResult"),!0)}})),BGResult:v(k,null,v(he,{queue:o}),v(pe,{guests:Object.values(l),result:a,onDone:()=>d("ChooseParty")}))}[_]}function Se({onAccept:e}){return v(k,null,v("h1",{className:"text-xl font-semibold"},"Warning!"),v("p",null,'Use at your own risk. BG1 is highly experimental, for demonstration purposes only, and provided "as is" without warranty of any kind. It could stop working at any time for any reason. There is no guarantee that using BG1 will actually help you obtain a boarding group, and it should not be relied on for this or any other purpose. Always use the official Disney app.'),v(ae,{onClick:e},"Accept"))}const Pe="https://cdn.registerdisney.go.com/v2/TPR-WDW-LBSDK.IOS-PROD/en-US?include=l10n,config,html,js&buildId=1785bba1445";class Ce{constructor(e,t,n=!1){this.iframe=e,this.logging=n,this.handlers={},this.handshakeAcked=!1,this.onMessage=e=>{if(e.source!==this.iframe.contentWindow)return;if("inner.loaded"===e.data)return;const t=JSON.parse(e.data);this.logging&&console.log("Message:",t);const n="message"===t.type?t.eventName:t.type,o=this.handlers[n],r=o?o("data"in t?t.data:null):void 0;var s;"deferredUuid"in(s=t)&&void 0!==s.deferredUuid&&this.send({type:"deferred",action:"resolve",deferredUuid:t.deferredUuid,data:void 0===r?{}:r})},this.on("handshake",(()=>{this.handshakeAcked||(this.handshakeAcked=!0,this.send({type:"handshakeAck"}),this.logging&&this.sendMessage("setLogLevel",{level:"log"}),this.sendMessage("workflow.execute",{name:"login"}))})),this.on("lightbox.hide",(()=>this.open())),this.on("session.loggedin",(({token:e})=>{t(e.access_token,new Date(e.expires))}))}open(){addEventListener("message",this.onMessage),this.iframe.src=Pe.toString(),this.handshakeAcked=!1}close(){removeEventListener("message",this.onMessage)}on(e,t){this.handlers[e]=t}sendMessage(e,t){this.send({type:"message",eventName:e,data:t})}send(e){var t,n;null==(t=this.iframe.contentWindow)||t.postMessage(JSON.stringify((n=f({},e),l(n,u({name:"lightbox-client-window"})))),Pe)}}function Ee({onLogin:e}){const t=ne(null);return te((()=>{if(!t.current)return;const n=new Ce(t.current,e);return n.open(),()=>n.close()}),[t,e]),v("iframe",{ref:t,className:"fixed top-0 left-0 w-full h-full border-0"})}function Ie(){return v(k,null,v("h1",{className:"text-xl font-semibold"},"Unable to Load BG1"),v("p",null,"BG1 can only be loaded from a resource on Disney's virtual queue server. Run the bookmarklet again after clicking the button below."),v(ae,{href:"https://vqguest-svc-wdw.wdprapps.disney.com/application/v1/guest/getQueues"},"Go to Virtual Queue Page"))}function Te({accessToken:e,client:t}){const[n,o]=ee("Blank"),[r,s]=function(e=localStorage,t="disclaimerAccepted"){const[n,o]=ee(!!e.getItem(t));return te((()=>{n&&e.setItem(t,"1")}),[n,e,t]),[n,()=>o(!0)]}();te((()=>{if("https://vqguest-svc-wdw.wdprapps.disney.com"!==location.origin)return o("WrongPage");if(!r)return o("Disclaimer");try{e.get()}catch(t){if(t instanceof M)return o("LoginForm");throw t}o("BGClient")}),[e,r]);return v("div",{className:"max-w-2xl mx-auto px-3 py-2"},{Blank:v("div",null),WrongPage:v(Ie,null),Disclaimer:v(Se,{onAccept:s}),LoginForm:v(Ee,{onLogin:function(t,n){e.set(t,n),o("BGClient")}}),BGClient:v(Ne,{client:t})}[n])}document.head.innerHTML+='\n  <meta name=viewport content="width=device-width, initial-scale=1, maximum-scale=1">\n  <title>BG1</title>\n';const qe=document.body;qe.className="bg-gray-50 text-black",qe.addEventListener("click",(()=>null));const De=new class{constructor(e,t=localStorage){this.name=e,this.storage=t}get(){const e=this.storage.getItem(this.name);if(e){const{token:t,expires:n}=JSON.parse(e),o=H(new Date(n)),r=H();if(o.date>r.date||o.date===r.date&&o.time>r.time&&o.time>="17")return t}throw new M(this.name)}set(e,t){this.storage.setItem(this.name,JSON.stringify({token:e,expires:t}))}delete(){this.storage.removeItem(this.name)}}("accessToken"),Ae=new class{constructor(e,t){this.fetch=e,this.getAccessToken=t}async getQueues(){return(await this.fetch(B("getQueues"))).data.queues}async getQueue(e){const t=(await this.getQueues()).find((t=>t.queueId===e.queueId));if(t)return t;throw new Error("Queue not Found")}async getLinkedGuests(e){const t=await this.post({resource:"getLinkedGuests",data:{queueId:e.queueId}});return t.guests.map((e=>({guestId:e.guestId,firstName:e.firstName,lastName:e.lastName,avatarImageUrl:e.avatarImageUrl,isPrimaryGuest:e.isPrimaryGuest,isPreselected:e.isPreselected}))).sort(((e,t)=>e.isPrimaryGuest!==t.isPrimaryGuest?e.isPrimaryGuest?-1:1:e.isPreselected!==t.isPreselected?e.isPreselected?-1:1:`${e.firstName} ${e.lastName}`.localeCompare(`${t.firstName} ${t.lastName}`)))}async joinQueue(e,t){const n=t.map((e=>e.guestId)),o=await this.post({resource:"joinQueue",data:{queueId:e.queueId,guestIds:n}});if("OK"===o.responseStatus){const t=o.positions.find((t=>t.queueId===e.queueId&&t.guestIds.length>0&&n.some((e=>t.guestIds.includes(e)))));if(!t)throw new Q(o);return{boardingGroup:t.boardingGroup,conflicts:{},closed:!1}}if("INVALID_GUEST"===o.responseStatus||"CLOSED_QUEUE"===o.responseStatus){const n="CLOSED_QUEUE"===o.responseStatus,r=new Set,s={};for(const e of o.conflicts)for(const n of e.guestIds){const o=t.find((e=>e.guestId===n));o&&(s[o.guestId]=e.conflictType,r.add(n))}const i=t.filter((e=>!r.has(e.guestId)));if(n||0===i.length)return{boardingGroup:null,conflicts:s,closed:n};const l=await this.joinQueue(e,i);return l.conflicts=f(f({},s),l.conflicts),l}throw new Q(o)}async post(e){const{status:t,data:n}=await this.fetch(B(e.resource),{method:"POST",headers:{"Content-Type":"application/json",Authorization:`BEARER ${await this.getAccessToken()}`},body:"data"in e?JSON.stringify(e.data):""});if(t>=500)throw new Q(n);return n}}((async function(e,t={}){const n=await fetch(e,t);return{status:n.status,data:await n.json()}}),(()=>De.get()));var Oe,Ge,Le,Ue,je,He;Oe=v(Te,{accessToken:De,client:Ae}),Ge=qe,t.__&&t.__(Oe,Ge),je=(Ue="function"==typeof Le)?null:Le&&Le.__k||Ge.__k,He=[],O(Ge,Oe=(!Ue&&Le||Ge).__k=v(k,null,[Oe]),je||h,h,void 0!==Ge.ownerSVGElement,!Ue&&Le?[Le]:je?null:Ge.firstChild?e.call(Ge.childNodes):null,He,!Ue&&Le?Le:je?je.__e:Ge.firstChild,Ue),G(He,Oe);
